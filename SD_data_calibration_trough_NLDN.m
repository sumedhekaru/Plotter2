function SD_data_calibration_trough_NLDN

nldnI = [-30
-11.4
-15.7
-13.6
-24.4
-58.3
-43.4
-19
-10.4
-41.2
-13.8
-28.9
-26.7
-23.1
-23.2
-29.7
-10
-21.7
-47
-6
-39.5
-22.2
-11.7
-25.2
-38.4
-23.2
-43.4
-22
-12.7
-70.3
-55.5
-21.1
-45.3
-27.1
-15.9
-25.4
-14.9
-22.4
-39.9
-18.5
0];

Vs = [18.3998
8.6973
10.7812
11.0177
15.0327
12.862
45.8977
9.7016
4.3917
19.8453
7.7695
17.9289
13.5689
10.6221
13.5236
15.7469
4.4716
12.5623
22.9676
3.6339
23.7565
13.7873
6.3651
10.3244
17.903
18.5899
35.4689
12.9016
7.7175
36.9281
23.8189
13.3191
29.8056
15.1075
8.367
20.7182
17.2994
23.5534
22.591
19.6425
0]/120;

B = -nldnI/0.185;
A = Vs;

[U,S,V] = svd([A(:) B(:)],0);
 m = -V(1,2)/V(2,2)


figure
plot(Vs,-nldnI/0.185,'ro','markerfacecolor','r')
xlabel('Field meter data (V)')
ylabel('NLDN I_p / 0.185')
title('Calibrating Rapid City - 2011/06/14 data')
hold all
%plot([0 max(Vs)], [0 max(Vs)*m])

%legend(sprintf('%i Points',length(Vs)),sprintf('Slope = %0.1f',m))
